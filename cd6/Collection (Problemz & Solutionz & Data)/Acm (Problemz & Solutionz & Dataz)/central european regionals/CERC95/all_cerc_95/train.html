<HTML>
<HEAD>
<TITLE>CERC 1995 - Problem B: Transportation</TITLE>
<!--HTML version generated by Kotas & Koucky 1998-->
</HEAD>

<BODY>
<H2 ALIGN=CENTER>ACM International Collegiate Programming Contest 95/96</H2>
<P  ALIGN=CENTER><B>Sponsored by Microsoft</B>
<H3 ALIGN=CENTER>Central European Regional Contest</H3>
<BR>
<H2 ALIGN=CENTER>Problem B: Transportation</H2>
<P ALIGN=CENTER>
<B>Input file:</B> <tt>train.in</tt><BR>
<B>Output file:</B> <tt>train.out</tt><BR>
<B>Program file:</B> <tt>train.pas</tt> or <tt>train.cpp</tt><P>
Ruratania is just entering capitalism and is establishing new enterprising activities in many fields in-
cluding transport. The transportation company TransRuratania is starting a new express train from city <I>A</I>
to city <I>B</I> with several stops in the stations on the way. The stations are successively numbered, city <I>A</I> station
has number 0, city <I>B</I> station number <I>m</I>. The company runs an experiment in order to improve passenger
transportation capacity and thus to increase its earnings. The train has a maximum capacity <I>n</I> passengers.
The price of the train ticket is equal to the number of stops (stations) between the starting station and the
destination station (including the destination station). Before the train starts its route from the city <I>A</I>, ticket
orders are collected from all onroute stations. The ticket order from the station <I>S</I> means all reservations of
tickets from <I>S</I> to a fixed destination station. In case the company cannot accept all orders because of the
passenger capacity limitations, its rejection policy is that it either completely accept or completely reject
single orders from single stations.<P>
Write a program which for the given list of orders from single stations on the way from <I>A</I> to <I>B</I> determines
the biggest possible total earning of the TransRuratania company. The earning from one accepted order is
the product of the number of passengers included in the order and the price of their train tickets. The total
earning is the sum of the earnings from all accepted orders.
<H3>Input</H3>
The input file is divided into blocks. The first line in each block contains three integers: passenger
capacity <I>n</I> of the train, the number of the city <I>B</I> station and the number of ticket orders from all stations.
The next lines contain the ticket orders. Each ticket order consists of three integers: starting station,
destination station, number of passengers. In one block there can be maximum 22 orders. The number of
the city <I>B</I> station will be at most 7. The block where all three numbers in the first line are equal to zero
denotes the end of the input file.
<H3>Output</H3>
The output file consists of lines corresponding to the blocks of the input file except the terminating
block. Each such line contains the biggest possible total earning.
<H3>Example</H3>
<B>Input file:</B>
<PRE>
10 3 4
0 2 1
1 3 5
1 2 7
2 3 10
10 5 4
3 5 10
2 4 9
0 2 5
2 5 8
0 0 0
</PRE>
<B>Output file:</B>
<PRE>
19
34
</PRE>
</BODY>
</HTML>
