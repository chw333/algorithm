<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0047)http://www.ii.uni.wroc.pl/boi/task/poszad.phtml -->
<HTML><HEAD><TITLE>Postman</TITLE>
<META content="text/html; charset=ks_c_5601-1987" http-equiv=Content-Type><LINK 
href="Postman.files/oi.css" rel=stylesheet>
<META content="MSHTML 5.00.3315.2870" name=GENERATOR></HEAD>
<BODY background=Postman.files/tlo.jpg bgColor=#ff7f00>
<TABLE bgColor=#ff7f00 border=0 cellPadding=0 cellSpacing=0 width="100%">
  <TBODY>
  <TR>
    <TD><IMG border=0 src="Postman.files/rlg.gif" width=12></TD>
    <TD><IMG border=0 height=12 src="Postman.files/dl.gif" width="100%"></TD>
    <TD><IMG border=0 height=12 src="Postman.files/dl.gif" width="100%"></TD>
    <TD><IMG border=0 src="Postman.files/rpg.gif" width=12></TD></TR>
  <TR>
    <TD><IMG border=0 height=80 src="Postman.files/dpion.gif" width=12></TD>
    <TD id=Htop width="100%">Postman</TD>
    <TD><IMG align=middle src="Postman.files/LOGO.gif"></TD>
    <TD><IMG border=0 height=80 src="Postman.files/dpion.gif" width=12></TD></TR>
  <TR>
    <TD><IMG border=0 src="Postman.files/rld.gif" width=12></TD>
    <TD><IMG border=0 height=12 src="Postman.files/dl.gif" width="100%"></TD>
    <TD><IMG border=0 height=12 src="Postman.files/dl.gif" width="100%"></TD>
    <TD><IMG border=0 src="Postman.files/rpd.gif" 
width=12></TD></TR></TBODY></TABLE>
<P>In a countryside a postman has to deliver post to customers that live in 
villages and along every road connecting the villages.</P>
<P>Your task is to help the postman design a route that goes though every 
village and every road at least once--the input data are such that this is 
always possible. However, each route also has a cost. The people in the villages 
wish that the postman visit their village as early as possible. Therefore, each 
village has made the following deal with the post: If the village <I>i</I> is 
visited as the <I>k</I>-th \textbfdifferent village on the tour and 
<I>k&lt;=w(i)</I>, the village pays <I>w(i)-k</I> euros to the post. However, if 
<I>k&gt;w(i)</I>, the post agrees to pay <I>k-w(i)</I> euros to the village. 
Moreover, the post pays the postman one euro for each road on the tour.</P>
<P>There are <I>n</I> villages, numbered form 1 to <I>n</I>. The post is located 
in the village number one, so the route should start and end in this village. 
Each village is placed on the crossing of two roads, on the crossing of four 
roads, or there is a road going through the village (i.e. there are 2, 4, or 8 
roads going out of each village). There can be several roads connecting the same 
villages or a road can be a loop, i.e. connect a village with itself. 
<H2>Task</H2>
<P>Your task is to write a program that: 
<UL>
  <LI>reads the description of villages and connecting them roads, from the 
  input file <TT>pos.in</TT>, 
  <LI>designs such a route that goes through each village and road at least once 
  and maximizes the total profit (or minimizes the loss) of the post, 
  <LI>writes the result to the output file <TT>pos.out</TT>. </LI></UL>
<P>If there are several possible solutions, your program should output just one 
of them. 
<H2>Input</H2>
<P>In the first line of the input file <TT>pos.in</TT>, there are two integers 
<I>n</I> and <I>m</I>, separated by a single space; <I>n</I>, 
<I>1&lt;=n&lt;=200</I>, is the number of villages and <I>m</I> is the number of 
roads. In each of the following <I>n</I> lines there is one positive integer. 
The <I>i+1</I>-th line contains <I>w(i)</I>, <I>1&lt;=w(i)&lt;=1&nbsp;000</I>, 
specification of the fee paid by the village number <I>i</I>. In each of the 
following <I>m</I> lines there are two positive integers separated by a single 
space--villages connected by consecutive roads. 
<H2>Output</H2>
<P>Your program should write one positive integer <I>k</I>, the length of the 
route, to the first line of the output file <TT>pos.out</TT>. The following line 
should contain <I>k+1</I> numbers of consecutive villages on the route 
<I>v<SUB>1</SUB>,v<SUB>2</SUB>,...,v<SUB>k+1</SUB></I>, separated by single 
spaces, with <I>v<SUB>1</SUB>=v<SUB>k+1</SUB>=1</I>.</P><PRE>6 7
1
7
4
10
20
5
2 4
1 5
2 1
4 5
3 6
1 6
1 3</PRE><IMG src="Postman.files/pos1.gif"> 
<H2>Example</H2>
<P>
<P>Input file <TT>pos.in</TT>: <PRE>6 7
1
7
4
10
20
5
2 4
1 5
2 1
4 5
3 6
1 6
1 3</PRE>
<P>correct answer in file <TT>pos.out</TT> <PRE>7
1 5 4 2 1 6 3 1</PRE><A href="javascript:window.history.go(-1)">Back</A> 
</BODY></HTML>
