#include <fstream.h>
#include <string.h>
#include <process.h>

int nn=0,ret;
char data[100][100],instr[100];

void btrack(int a,int b,int c)
{
    int i;
    if(c==strlen(data[1])) c=0;
    if(b==strlen(data[0])) b=0;
    if(a==strlen(instr))
    {
        cout << "It is similar to standard." << endl;
        ret=1;
        return;
    }
    if((b==0) && (c==0))
    {
        if(instr[a]==data[0][b])
        {
            btrack(a+1,b+1,c);
            if(ret) return;
        }
        if(instr[a]==data[1][c])
        {
            btrack(a+1,b,c+1);
            if(ret) return;
        }
    }
    if(b)
    {
        if(data[0][b]=='N')
        {
            for(i=a;i<strlen(instr);i++)
            {
                if(instr[i]!=data[0][b-1])
                {
                    btrack(i,b+1,c);
                    return;
                }
            }
        }
        if(data[0][b]==instr[a])
        {
            btrack(a+1,b+1,c);
            if(ret) return;
        }
    }
    if(c)
    {
        if(data[1][c]=='N')
        {
            for(i=a;i<strlen(instr);i++)
            {
                if(instr[i]!=data[1][c-1])
                {
                    btrack(i,b,c+1);
                    return;
                }
            }
        }
        if(data[1][c]==instr[a])
        {
            btrack(a+1,b,c+1);
            if(ret) return;
        }
    }
}

void main(void)
{
    int p,i;
    cout << "Input Standard Mosaic ?";
    cin.getline(instr,100);
    p=0;
    for(i=0;i<strlen(instr);i++)
    {
        if(instr[i]==',')
        {
            strncpy(data[nn++],instr+p,i-p);
            p=i+1;
        }
    }
    strncpy(data[nn++],instr+p,strlen(instr)-p);
a:
    cout << "Mosaic to Decrypt?";
    cin.getline(instr,100);
    ret=0;
    btrack(0,0,0);
    if(!ret)
    {
        cout << "It is different to standard" << endl;
        goto a;
    }
    goto a;
}