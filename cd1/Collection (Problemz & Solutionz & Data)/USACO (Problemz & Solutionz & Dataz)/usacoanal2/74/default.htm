<html>
<head> <title>Analysis 74: Checker Challenge</title> </head>
<body background="../../usaco/bg3.jpg">
<img src="../../usaco/cow1.jpg" width="742" height="118">
<center>
<b><font size="7">Checker Challenge</font></b><br>
Russ Cox
</center>
<html>

<p>We use a recursive complete search to simply test all boards.  The
search proceeds by trying to put one checker in each row.  We keep track
of which columns and diagonals already have checkers on them in the
"col", "updiag", and "downdiag" arrays.

<p>Since we generate solutions in increasing order, we record the first
3 in the "sol" array.

<p>Since we number rows from 0 to N-1 rather than 1 to N, we need to
add 1 to each digit as we print (in "printsol").

<pre>
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
#include &lt;assert.h&gt;

#define MAXN 13
#define NPRINT 3

int n;
int nsol;
FILE *fout;

void
solution(int *a)
{
    int i;

    if(nsol == NPRINT)
	return;

    nsol++;

    for(i=0; i&lt;n; i++) {
	if(i != 0)
	    fprintf(fout, " ");
	fprintf(fout, "%d", a[i]+1);
    }
    fprintf(fout, "\n");
}

/* Keep track of whether there is a checker on each column, and diagonal. */
int col[MAXN];		/* (i, j) -&gt; j */
int updiag[2*MAXN];	/* (i, j) -&gt; i+j */
int downdiag[2*MAXN];	/* (i, j) -&gt; i-j + N */

/*
 * Calculate number of ways to place checkers
 * on each row of the board starting at row i and going to row n.
 */
int
nway(int i, int *row)
{
    int j, s;

    if(i == n) {
	solution(row);
	return 1;
    }

    s = 0;
    for(j=0; j&lt;n; j++){
	if(!col[j] &amp;&amp; !updiag[i+j] &amp;&amp; !downdiag[i-j+MAXN]){
	    row[i] = j;

	    col[j]++;
	    updiag[i+j]++;
	    downdiag[i-j+MAXN]++;

	    s += nway(i+1, row);

	    col[j]--;
	    updiag[i+j]--;
	    downdiag[i-j+MAXN]--;
	}
    }
    return s;
}

void
main(void)
{
    FILE *fin;
    int i, s, row[MAXN];
    
    fin = fopen("checker.in", "r");
    assert(fin != NULL);
    fout = fopen("checker.out", "w");
    assert(fout != NULL);

    fscanf(fin, "%d", &amp;n);
    s = nway(0, row);
    fprintf(fout, "%d\n", s);
}
</pre>
<center>
<a href="../BACK/default.htm">USACO Gateway</a> | <a href="mailto:kolstad@ace.delos.com">Comment or Question</a>
</center>
</body>
